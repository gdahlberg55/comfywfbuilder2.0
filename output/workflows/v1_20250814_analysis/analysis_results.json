{
  "workflow_name": "Wan 2.1 - seamless loop workflow v1.2",
  "analysis_timestamp": "2025-08-14T10:00:00Z",
  "node_count": 61,
  "link_count": 71,
  "group_count": 3,
  
  "node_topology": {
    "input_nodes": [
      {
        "id": 98,
        "type": "CLIPLoaderMultiGPU",
        "position": [-1780, -1770],
        "outputs": ["CLIP to nodes 14, 118"]
      },
      {
        "id": 97,
        "type": "UnetLoaderGGUFDisTorchMultiGPU",
        "position": [-1780, -1970],
        "outputs": ["MODEL to node 95"]
      },
      {
        "id": 99,
        "type": "VAELoaderMultiGPU",
        "position": [-1780, -1620],
        "outputs": ["VAE to nodes 315, 322, 320"]
      },
      {
        "id": 339,
        "type": "LoadImage",
        "position": [-1780, -1380],
        "outputs": ["IMAGE to node 112", "MASK to node 109"]
      }
    ],
    
    "processing_chains": [
      {
        "chain_name": "Model Processing Chain",
        "nodes": [97, 95, 236, 48, 28, 84, 50, 54],
        "flow": "UnetLoader -> LoRA loaders -> ModelSampling -> PatchAttention -> PatchOrder -> VideoEnhance -> TeaCache"
      },
      {
        "chain_name": "Image Processing Chain",
        "nodes": [339, 112, 109, 96],
        "flow": "LoadImage -> cleanGPU -> CropByMask -> ImageResize"
      },
      {
        "chain_name": "Conditioning Chain",
        "nodes": [98, 118, 14, 17, 16, 315],
        "flow": "CLIP -> TextEncode (positive/negative) -> CLIPVision -> ImageToVideo"
      },
      {
        "chain_name": "Sampling Chain",
        "nodes": [310, 318, 319, 317, 314, 313, 312, 316, 311],
        "flow": "Two-pass sampling with CFGGuider, Samplers, Sigmas split"
      },
      {
        "chain_name": "Post-Processing Chain",
        "nodes": [322, 323, 320, 306, 276, 279, 290, 249, 281, 282, 293, 294, 291, 305, 358, 221, 359, 222],
        "flow": "VAEDecode -> Frame operations -> RIFE interpolation -> Video combine"
      }
    ],
    
    "output_nodes": [
      {
        "id": 321,
        "type": "VHS_VideoCombine",
        "position": [630, -1970],
        "purpose": "First pass video output"
      },
      {
        "id": 38,
        "type": "VHS_VideoCombine",
        "position": [2000, -1970],
        "purpose": "Preview with frame skip and interpolation"
      },
      {
        "id": 299,
        "type": "VHS_VideoCombine",
        "position": [2450, -1970],
        "purpose": "Preview without interpolation"
      },
      {
        "id": 222,
        "type": "VHS_VideoCombine",
        "position": [3470, -1720],
        "purpose": "Final output with full interpolation"
      }
    ]
  },
  
  "current_routing_problems": {
    "spline_overlaps": [
      {
        "description": "Long spline connections from input loaders to processing nodes",
        "examples": [
          "Link 275: Node 97 to 95 spans 500px horizontally",
          "Link 503: Node 99 to 315 spans 1480px horizontally"
        ]
      },
      {
        "description": "Complex crossovers in sampling chain area",
        "area": "[-300, -1970] to [380, -1200]",
        "node_density": "High - 14 nodes in confined space"
      },
      {
        "description": "Multiple parallel connections requiring separation",
        "examples": [
          "Model outputs from node 54 (514, 515, 516) to different targets",
          "Image outputs from node 249 spreading to 5 different targets"
        ]
      }
    ],
    
    "long_distance_connections": [
      {
        "link": 503,
        "from": "Node 99 [-1780, -1620]",
        "to": "Node 315 [-300, -1970]",
        "distance": "1480px horizontal, 350px vertical"
      },
      {
        "link": 529,
        "from": "Node 96 [-1280, -1530]",
        "to": "Node 306 [100, -1230]",
        "distance": "1380px horizontal, 300px vertical"
      },
      {
        "link": 555,
        "from": "Node 221 [3470, -1970]",
        "to": "Node 247 [2900, -1970]",
        "distance": "570px horizontal"
      }
    ]
  },
  
  "data_flow_patterns": {
    "bus_lane_requirements": [
      {
        "bus_type": "MODEL",
        "source": "Node 97",
        "destinations": [95, 236, 48, 28, 84, 50, 54, 310, 312, 317],
        "recommended_y_position": -2100
      },
      {
        "bus_type": "CLIP",
        "source": "Node 98",
        "destinations": [14, 118],
        "recommended_y_position": -1900
      },
      {
        "bus_type": "VAE",
        "source": "Node 99",
        "destinations": [315, 322, 320],
        "recommended_y_position": -1700
      },
      {
        "bus_type": "IMAGE",
        "source": "Node 96",
        "destinations": [110, 16, 315, 306],
        "recommended_y_position": -1500
      },
      {
        "bus_type": "CONDITIONING",
        "sources": [118, 14],
        "destinations": [315, 310, 312],
        "recommended_y_position": -1400
      }
    ],
    
    "parallel_flows": [
      {
        "flow_name": "Two-pass sampling",
        "parallel_branches": [
          "First pass: 310->313->322->323",
          "Second pass: 312->316->320"
        ],
        "requires_vertical_separation": true
      }
    ]
  },
  
  "existing_groups": [
    {
      "id": 1,
      "title": "full interpolation and save",
      "bounding": [3460, -2040, 744, 1450],
      "nodes": [221, 222, 349, 356, 359],
      "color": "#3f789e"
    },
    {
      "id": 2,
      "title": "start-end settings",
      "bounding": [1600, -2000, 272, 354],
      "nodes": [277, 278, 301, 300],
      "color": "#8A8"
    },
    {
      "id": 3,
      "title": "Magic stuff",
      "bounding": [1460, -1414, 479, 284],
      "nodes": [276, 279, 290, 294, 249, 293, 281, 291, 282, 304, 305, 358],
      "color": "#444"
    }
  ],
  
  "organization_issues": {
    "node_overlap_areas": [
      {
        "area": "Sampling chain region",
        "description": "Nodes 310-319 are tightly packed with overlapping connections"
      },
      {
        "area": "Post-processing region",
        "description": "Complex routing between frame manipulation nodes"
      }
    ],
    
    "grouping_improvements": [
      {
        "suggested_group": "Input Loaders",
        "nodes": [97, 98, 99, 339],
        "reason": "All input nodes should be grouped together"
      },
      {
        "suggested_group": "Model Pipeline",
        "nodes": [95, 236, 48, 28, 84, 50, 54],
        "reason": "Sequential model processing chain"
      },
      {
        "suggested_group": "Sampling System",
        "nodes": [310, 312, 313, 316, 317, 314, 318, 311, 319],
        "reason": "Two-pass sampling components"
      }
    ],
    
    "spacing_requirements": {
      "current_issues": [
        "Nodes too close in sampling area",
        "Long diagonal connections across workflow",
        "Insufficient vertical separation for parallel flows"
      ],
      "recommendations": [
        "Increase horizontal spacing to 1000-1500px between major stages",
        "Add 500px vertical separation between parallel sampling passes",
        "Create dedicated routing channels every 200px vertically"
      ]
    }
  },
  
  "engineering_routing_plan": {
    "routing_channels": {
      "horizontal_buses": [
        {"y": -2100, "purpose": "MODEL bus", "color": "#FF6B6B"},
        {"y": -1900, "purpose": "CLIP bus", "color": "#4ECDC4"},
        {"y": -1700, "purpose": "VAE bus", "color": "#45B7D1"},
        {"y": -1500, "purpose": "IMAGE bus", "color": "#96CEB4"},
        {"y": -1300, "purpose": "CONDITIONING bus", "color": "#FECA57"}
      ],
      "vertical_lanes": [
        {"x": -1800, "purpose": "Input zone"},
        {"x": -1200, "purpose": "Model processing zone"},
        {"x": -600, "purpose": "Conditioning zone"},
        {"x": 0, "purpose": "Sampling zone"},
        {"x": 600, "purpose": "First output zone"},
        {"x": 1500, "purpose": "Frame processing zone"},
        {"x": 2500, "purpose": "Preview zone"},
        {"x": 3500, "purpose": "Final output zone"}
      ]
    },
    
    "connection_breakout_strategy": {
      "method": "Orthogonal routing with bus lanes",
      "rules": [
        "All connections exit nodes at right angles",
        "Long connections use horizontal bus lanes",
        "Vertical drops at destination x-coordinate",
        "Minimum 40px spacing between parallel routes",
        "Corner radius: 0 (sharp 90-degree turns)"
      ]
    }
  }
}